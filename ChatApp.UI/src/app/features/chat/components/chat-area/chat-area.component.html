<section class="dark:bg-neutral-900 max-h-[100dvh] flex flex-col h-full message-container">
  <!-- Header -->
  <div
    class="flex justify-between items-center h-[4rem] border-b border-neutral-200 dark:border-neutral-700"
  >
    <div class="ml-3 md:hidden">
      <svg
        class="size-8"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        (click)="openSidebar()"
      >
        <g>
          <path
            id="Vector"
            d="M3 17H21M3 12H21M3 7H21"
            class="stroke-neutral-700 dark:stroke-neutral-500 stroke-2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </g>
      </svg>
    </div>
    <span class="text-lg font-bold dark:text-neutral-400 ml-3">Senate</span>

    <div class="flex items-center select-none">
      <svg
        class="size-7 group cursor-pointer mx-2"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M14.3308 15.9402L15.6608 14.6101C15.8655 14.403 16.1092 14.2384 16.3778 14.1262C16.6465 14.014 16.9347 13.9563 17.2258 13.9563C17.517 13.9563 17.8052 14.014 18.0739 14.1262C18.3425 14.2384 18.5862 14.403 18.7908 14.6101L20.3508 16.1702C20.5579 16.3748 20.7224 16.6183 20.8346 16.887C20.9468 17.1556 21.0046 17.444 21.0046 17.7351C21.0046 18.0263 20.9468 18.3146 20.8346 18.5833C20.7224 18.8519 20.5579 19.0954 20.3508 19.3L19.6408 20.02C19.1516 20.514 18.5189 20.841 17.8329 20.9541C17.1469 21.0672 16.4427 20.9609 15.8208 20.6501C10.4691 17.8952 6.11008 13.5396 3.35083 8.19019C3.03976 7.56761 2.93414 6.86242 3.04914 6.17603C3.16414 5.48963 3.49384 4.85731 3.99085 4.37012L4.70081 3.65015C5.11674 3.23673 5.67937 3.00464 6.26581 3.00464C6.85225 3.00464 7.41488 3.23673 7.83081 3.65015L9.40082 5.22021C9.81424 5.63615 10.0463 6.19871 10.0463 6.78516C10.0463 7.3716 9.81424 7.93416 9.40082 8.3501L8.0708 9.68018C8.95021 10.8697 9.91617 11.9926 10.9608 13.04C11.9994 14.0804 13.116 15.04 14.3008 15.9102L14.3308 15.9402Z"
          class="stroke-2 stroke-neutral-600 group-hover:stroke-neutral-800 dark:stroke-neutral-500 dark:group-hover:stroke-neutral-300"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>

      <svg
        class="size-6 group cursor-pointer mx-2"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg "
      >
        <circle
          cx="12"
          cy="12"
          r="3"
          class="stroke-2 stroke-neutral-600 group-hover:stroke-neutral-800 dark:stroke-neutral-500 dark:group-hover:stroke-neutral-300"
        />
        <path
          d="M13.7654 2.15224C13.3978 2 12.9319 2 12 2C11.0681 2 10.6022 2 10.2346 2.15224C9.74457 2.35523 9.35522 2.74458 9.15223 3.23463C9.05957 3.45834 9.0233 3.7185 9.00911 4.09799C8.98826 4.65568 8.70226 5.17189 8.21894 5.45093C7.73564 5.72996 7.14559 5.71954 6.65219 5.45876C6.31645 5.2813 6.07301 5.18262 5.83294 5.15102C5.30704 5.08178 4.77518 5.22429 4.35436 5.5472C4.03874 5.78938 3.80577 6.1929 3.33983 6.99993C2.87389 7.80697 2.64092 8.21048 2.58899 8.60491C2.51976 9.1308 2.66227 9.66266 2.98518 10.0835C3.13256 10.2756 3.3397 10.437 3.66119 10.639C4.1338 10.936 4.43789 11.4419 4.43786 12C4.43783 12.5581 4.13375 13.0639 3.66118 13.3608C3.33965 13.5629 3.13248 13.7244 2.98508 13.9165C2.66217 14.3373 2.51966 14.8691 2.5889 15.395C2.64082 15.7894 2.87379 16.193 3.33973 17C3.80568 17.807 4.03865 18.2106 4.35426 18.4527C4.77508 18.7756 5.30694 18.9181 5.83284 18.8489C6.07289 18.8173 6.31632 18.7186 6.65204 18.5412C7.14547 18.2804 7.73556 18.27 8.2189 18.549C8.70224 18.8281 8.98826 19.3443 9.00911 19.9021C9.02331 20.2815 9.05957 20.5417 9.15223 20.7654C9.35522 21.2554 9.74457 21.6448 10.2346 21.8478C10.6022 22 11.0681 22 12 22C12.9319 22 13.3978 22 13.7654 21.8478C14.2554 21.6448 14.6448 21.2554 14.8477 20.7654C14.9404 20.5417 14.9767 20.2815 14.9909 19.902C15.0117 19.3443 15.2977 18.8281 15.781 18.549C16.2643 18.2699 16.8544 18.2804 17.3479 18.5412C17.6836 18.7186 17.927 18.8172 18.167 18.8488C18.6929 18.9181 19.2248 18.7756 19.6456 18.4527C19.9612 18.2105 20.1942 17.807 20.6601 16.9999C21.1261 16.1929 21.3591 15.7894 21.411 15.395C21.4802 14.8691 21.3377 14.3372 21.0148 13.9164C20.8674 13.7243 20.6602 13.5628 20.3387 13.3608C19.8662 13.0639 19.5621 12.558 19.5621 11.9999C19.5621 11.4418 19.8662 10.9361 20.3387 10.6392C20.6603 10.4371 20.8675 10.2757 21.0149 10.0835C21.3378 9.66273 21.4803 9.13087 21.4111 8.60497C21.3592 8.21055 21.1262 7.80703 20.6602 7C20.1943 6.19297 19.9613 5.78945 19.6457 5.54727C19.2249 5.22436 18.693 5.08185 18.1671 5.15109C17.9271 5.18269 17.6837 5.28136 17.3479 5.4588C16.8545 5.71959 16.2644 5.73002 15.7811 5.45096C15.2977 5.17191 15.0117 4.65566 14.9909 4.09794C14.9767 3.71848 14.9404 3.45833 14.8477 3.23463C14.6448 2.74458 14.2554 2.35523 13.7654 2.15224Z"
          class="stroke-2 stroke-neutral-600 group-hover:stroke-neutral-800 dark:stroke-neutral-500 dark:group-hover:stroke-neutral-300"
        />
      </svg>
      <div class="cursor-pointer mr-3">
        @if(isDark){
        <svg
          class="size-7 fill-none select-none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          (click)="toggleTheme()"
        >
          <path
            d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z"
            class="stroke-white stroke-2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        }@else {

        <svg
          class="size-7 fill-none select-none"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
          (click)="toggleTheme()"
        >
          <path
            d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z"
            class="stroke-black stroke-2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        }
      </div>
    </div>
  </div>

  <!-- Messages (scrollable middle area) -->
  <div #chatContainer class="flex-1 overflow-y-auto p-4 space-y-2 w-full">
    <!-- Message start -->
    @for (message of messages; track $index) { @if($index == 0 || !isSameDay(message.sendDate,
    messages[$index-1].sendDate)){
    <div class="flex items-center justify-center my-4">
      <div class="border-b border-gray-300 dark:border-neutral-700 w-full"></div>
      <span class="px-3 text-xs text-gray-500 dark:text-neutral-500 whitespace-nowrap">
        {{ message.sendDate | date : "fullDate" }}
      </span>
      <div class="border-b border-gray-300 dark:border-neutral-700 w-full"></div>
    </div>
    }

    <div class="rounded w-fit min-w-[40%]">
      <!-- Message Header -->
      @if ($index === 0 || message.senderName !== messages[$index - 1].senderName) {
      <div class="flex justify-start items-center mb-3">
        <img
          src="https://picsum.photos/1920/1080"
          width="100"
          height="100"
          alt=""
          class="size-8 rounded-md mr-2"
        />
        <span class="text-sm text-neutral-800 dark:text-neutral-400">
          {{ message.senderName }}
        </span>
      </div>
      }

      <!-- Message Content -->
      <div class="text-sm dark:text-neutral-400 text-neutral-700 ml-[2.5rem]">
        {{ message.content }}
      </div>

      <!-- Message Footer -->
      <div class="flex justify-between mt-2 ml-[2rem]">
        <span class="text-xs text-neutral-400 dark:text-neutral-600">
          {{ message.sendDate | date : "HH:MM" }}
        </span>
      </div>
    </div>
    }
    <!-- Message end -->
  </div>

  <!-- Input area -->
  <form
    (ngSubmit)="sendMessage()"
    class="flex items-center p-2 border-t dark:border-neutral-600 h-[4rem]"
  >
    <svg
      class="size-10 cursor-pointer group fill-none"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M11.25 12.75V18H12.75V12.75H18V11.25H12.75V6H11.25V11.25H6V12.75H11.25Z"
        class="fill-neutral-500 dark:fill-neutral-400 group-hover:dark:fill-neutral-200"
      />
    </svg>

    <div class="relative flex items-center w-full ml-2">
      <svg
        class="absolute ml-2 size-6 cursor-pointer group fill-none"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M16 10.5C16 11.3284 15.5523 12 15 12C14.4477 12 14 11.3284 14 10.5C14 9.67157 14.4477 9 15 9C15.5523 9 16 9.67157 16 10.5Z"
          class="fill-indigo-500 dark:fill-indigo-500 group-hover:dark:fill-indigo-500"
        />
        <path
          d="M10 10.5C10 11.3284 9.55229 12 9 12C8.44772 12 8 11.3284 8 10.5C8 9.67157 8.44772 9 9 9C9.55229 9 10 9.67157 10 10.5Z"
          class="fill-indigo-500 dark:fill-indigo-500 group-hover:dark:fill-indigo-500"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 16.8562 6.49219 20.8383 11.2501 21.22C11.2516 19.732 11.2657 18.6267 11.3902 17.7177C10.3395 17.6057 9.36999 17.2078 8.55339 16.6025C8.22062 16.3559 8.15082 15.8862 8.39747 15.5534C8.64413 15.2206 9.11385 15.1508 9.44661 15.3975C10.1122 15.8908 10.9037 16.1944 11.7569 16.2431C12.5684 14.111 14.2803 12.4407 16.4403 11.6849C17.587 11.2837 18.9634 11.2524 21.22 11.2501C20.8383 6.49219 16.8562 2.75 12 2.75ZM21.1392 12.7508C18.8834 12.756 17.804 12.7969 16.9358 13.1007C15.1405 13.7289 13.7289 15.1405 13.1007 16.9358C12.7969 17.804 12.756 18.8834 12.7508 21.1392L21.1392 12.7508ZM1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12C22.75 12.3623 22.7321 12.7206 22.697 13.0741L22.6705 13.3408L13.3408 22.6705L13.0741 22.697C12.7206 22.7321 12.3623 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12Z"
          class="fill-indigo-500 dark:fill-indigo-500 group-hover:dark:fill-indigo-500"
        />
      </svg>

      <input
        type="text"
        placeholder="Type message #senate"
        name="message"
        [(ngModel)]="request.content"
        class="w-full dark:border-neutral-600 rounded-lg px-10 py-2 focus:outline-none dark:bg-neutral-800 dark:text-neutral-200 placeholder:text-neutral-300 dark:placeholder:text-neutral-600 placeholder:font-normal"
      />
    </div>
    @if(request.content == ""){
    <button type="button">
      <svg
        class="size-8 cursor-pointer group fill-none mx-2"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14.5 10.5V5.5C14.5 4.11929 13.3807 3 12 3C10.6193 3 9.5 4.11929 9.5 5.5V10.5C9.5 11.8807 10.6193 13 12 13C13.3807 13 14.5 11.8807 14.5 10.5ZM12 1C9.51472 1 7.5 3.01472 7.5 5.5V10.5C7.5 12.9853 9.51472 15 12 15C14.4853 15 16.5 12.9853 16.5 10.5V5.5C16.5 3.01472 14.4853 1 12 1Z"
          class="fill-indigo-500 dark:fill-indigo-500"
        />
        <path
          d="M12 17C5.49999 17 5.99999 12 5.99999 12C5.99999 12 6.00001 11 5.00001 11C4.00001 11 3.99999 12 3.99999 12C3.99999 12 3.54013 18.4382 11 18.9657V22C11 22.5523 11.4477 23 12 23C12.5523 23 13 22.5523 13 22V18.9657C20.4599 18.4382 20 12 20 12C20 12 20 11 19 11C18 11 18 12 18 12C18 12 18.5 17 12 17Z"
          class="fill-indigo-500 dark:fill-indigo-500"
        />
      </svg>
    </button>
    }@else {
    <button type="submit">
      <svg
        class="size-8 cursor-pointer group fill-none mx-2"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M11.5003 12H5.41872M5.24634 12.7972L4.24158 15.7986C3.69128 17.4424 3.41613 18.2643 3.61359 18.7704C3.78506 19.21 4.15335 19.5432 4.6078 19.6701C5.13111 19.8161 5.92151 19.4604 7.50231 18.7491L17.6367 14.1886C19.1797 13.4942 19.9512 13.1471 20.1896 12.6648C20.3968 12.2458 20.3968 11.7541 20.1896 11.3351C19.9512 10.8529 19.1797 10.5057 17.6367 9.81135L7.48483 5.24303C5.90879 4.53382 5.12078 4.17921 4.59799 4.32468C4.14397 4.45101 3.77572 4.78336 3.60365 5.22209C3.40551 5.72728 3.67772 6.54741 4.22215 8.18767L5.24829 11.2793C5.34179 11.561 5.38855 11.7019 5.407 11.8459C5.42338 11.9738 5.42321 12.1032 5.40651 12.231C5.38768 12.375 5.34057 12.5157 5.24634 12.7972Z"
          class="stroke-2 stroke-indigo-600 dark:stroke-indigo-500"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
    }
  </form>
</section>
